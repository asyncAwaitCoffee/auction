<template>
    <div class="card__wrapper" :class="{card__processing: !isDone}">
        <div class="loading__line"></div>
        <div class="item-name">
            {{ `${$store.state.loc == 'production' ? 'Recipe:' : ''} ${$props.box.item.title}` }}
            <span v-if="$store.state.loc != 'production'">({{ $props.box.quantity }})</span>
        </div>
        <div class="item-image">
            <div :style="`background: center / contain no-repeat url(${this.box.img}); width: 100%; height: 100%; filter: drop-shadow(0 0 2px black);`"></div>
        </div>
        <div class="item-info">
            <div class="item-text">
                <div>{{ this.box.text }}</div>
            </div>
            <div class="info__btns">
                <card-button
                    v-show="['bids', 'auction', 'favs'].includes(account.loc) && account.login != null"
                    class="btn__fav"
                    :class="{faved: $store.state.favs.has(this.box.lot_id)}"
                    @click="$store.commit('favLot', $props.box)"
                    title="Fav"
                >
                    <svg width="2em" height="2em" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.2691 4.41115C11.5006 3.89177 11.6164 3.63208 11.7776 3.55211C11.9176 3.48263 12.082 3.48263 12.222 3.55211C12.3832 3.63208 12.499 3.89177 12.7305 4.41115L14.5745 8.54808C14.643 8.70162 14.6772 8.77839 14.7302 8.83718C14.777 8.8892 14.8343 8.93081 14.8982 8.95929C14.9705 8.99149 15.0541 9.00031 15.2213 9.01795L19.7256 9.49336C20.2911 9.55304 20.5738 9.58288 20.6997 9.71147C20.809 9.82316 20.8598 9.97956 20.837 10.1342C20.8108 10.3122 20.5996 10.5025 20.1772 10.8832L16.8125 13.9154C16.6877 14.0279 16.6252 14.0842 16.5857 14.1527C16.5507 14.2134 16.5288 14.2807 16.5215 14.3503C16.5132 14.429 16.5306 14.5112 16.5655 14.6757L17.5053 19.1064C17.6233 19.6627 17.6823 19.9408 17.5989 20.1002C17.5264 20.2388 17.3934 20.3354 17.2393 20.3615C17.0619 20.3915 16.8156 20.2495 16.323 19.9654L12.3995 17.7024C12.2539 17.6184 12.1811 17.5765 12.1037 17.56C12.0352 17.5455 11.9644 17.5455 11.8959 17.56C11.8185 17.5765 11.7457 17.6184 11.6001 17.7024L7.67662 19.9654C7.18404 20.2495 6.93775 20.3915 6.76034 20.3615C6.60623 20.3354 6.47319 20.2388 6.40075 20.1002C6.31736 19.9408 6.37635 19.6627 6.49434 19.1064L7.4341 14.6757C7.46898 14.5112 7.48642 14.429 7.47814 14.3503C7.47081 14.2807 7.44894 14.2134 7.41394 14.1527C7.37439 14.0842 7.31195 14.0279 7.18708 13.9154L3.82246 10.8832C3.40005 10.5025 3.18884 10.3122 3.16258 10.1342C3.13978 9.97956 3.19059 9.82316 3.29993 9.71147C3.42581 9.58288 3.70856 9.55304 4.27406 9.49336L8.77835 9.01795C8.94553 9.00031 9.02911 8.99149 9.10139 8.95929C9.16534 8.93081 9.2226 8.8892 9.26946 8.83718C9.32241 8.77839 9.35663 8.70162 9.42508 8.54808L11.2691 4.41115Z"></path>
                    </svg>
                </card-button>
                <card-button
                    class="btn__info"
                    title="Info"
                >
                    <svg width="2em" height="2em" viewBox="-45 -125 512 512" xmlns="http://www.w3.org/2000/svg">
                        <path d="M426.666667,1.42108547e-14 L426.666667,341.333333 L3.55271368e-14,341.333333 L3.55271368e-14,1.42108547e-14 L426.666667,1.42108547e-14 Z M384,42.6666667 L42.6666667,42.6666667 L42.6666667,298.666667 L384,298.666667 L384,42.6666667 Z M341.333333,213.333333 L341.333333,245.333333 L234.666667,245.333333 L234.666667,213.333333 L341.333333,213.333333 Z M341.333333,149.333333 L341.333333,181.333333 L234.666667,181.333333 L234.666667,149.333333 L341.333333,149.333333 Z M192,85.3333333 L192,170.666667 L85.3333333,170.666667 L85.3333333,85.3333333 L192,85.3333333 Z M341.333333,85.3333333 L341.333333,117.333333 L234.666667,117.333333 L234.666667,85.3333333 L341.333333,85.3333333 Z" id="Combined-Shape"> </path>
                    </svg>
                </card-button>
            </div>
        </div>
        <div class="card__controls">
            <div class="card__btns">
                <card-button
                    v-if="['bids', 'auction', 'favs'].includes(account.loc) && account.login != null"
                    class="btn__buy"
                    :class="{no: this.box.price > account.money}"
                    @click="$store.commit('buyLot', $props.box)"
                    title="Buy"
                >
                    <svg class="svg__big" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                        <path d="M466.982,182.202l-47.984-28.906l47.984-28.875c9.469-5.719,12.516-18,6.813-27.469 c-5.688-9.469-17.984-12.5-27.453-6.813l-71.672,43.156H129.639c-11.047,0-20,8.969-20,20c0,11.063,8.953,20,20,20H374.67 l71.672,43.156c9.469,5.719,21.75,2.656,27.453-6.813S476.451,187.89,466.982,182.202z"></path>
                        <path d="M152.232,109.296h207.547l40.531-76.156c3.203-5.625,4.328-16.891-12.578-24.406 c-23.906-10.625-69.484,35.688-129.578,11.266C194.904-5.704,149.248-2.517,128.592,6.858 c-20.656,9.391-16.906,26.281-16.906,26.281L152.232,109.296z"></path>
                        <path d="M466.045,356.14c-13.906-21.438-65.219-104.781-98.422-158.844h-223.25 c-33.188,54.063-84.5,137.406-98.406,158.844C0.889,425.608-0.986,511.999,85.404,511.999h341.203 C512.982,511.999,511.107,425.608,466.045,356.14z M335.264,353.108c0,9.719-0.656,17.297-1.969,23.203 c-1.344,5.953-4.109,12.531-8.219,19.563c-4.172,7.109-9.766,13.531-16.641,19.125c-6.922,5.625-14.453,9.703-22.391,12.125 c-7.797,2.391-17.172,3.594-27.859,3.594c-24.578,0-44.531-7.891-59.297-23.469c-14.688-15.5-22.141-33.516-22.141-53.547 c0-21.078,7.656-39.281,22.734-54.094c15.078-14.797,33.578-22.297,54.984-22.297c12.531,0,24.172,1.938,34.578,5.766 c10.516,3.844,21.328,11.063,32.156,21.453l-20.031,20.031c-13.063-12.813-27.719-19.031-44.797-19.031 c-14.797,0-26.734,4.594-36.516,14.031c-9.734,9.406-14.469,20.844-14.469,34.984c0,12.297,4.625,23.109,14.125,33.047 c9.438,9.891,22.219,14.703,39.094,14.703c22.625,0,37.25-8.563,44.547-26.141H275.67v-27.578h59.594V353.108z"></path>
                    </svg>
                </card-button>
                <card-button
                    v-if="['auction', 'favs'].includes(account.loc) && account.login != null"
                    class="btn__bid"
                    :class="{bidded: $store.state.bids.has(this.box.lot_id), no: this.box.bid_step > account.money}"
                    @click="$store.commit('bidLot', $props.box)"
                    title="Bid"
                >
                    <svg class="svg__big" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                        <path d="M326.27,86.016l57.667,15.304c1.504,0.307,2.726,1.536,3.072,3.049l15.203,57.667 c0.41,1.693,1.899,2.883,3.631,2.883c1.749,0,3.222-1.19,3.615-2.883l15.226-57.667c0.323-1.512,1.552-2.742,3.056-3.049 l57.675-15.304c1.686-0.316,2.884-1.82,2.884-3.553c0-1.749-1.198-3.222-2.884-3.56L427.74,63.606 c-1.504-0.322-2.733-1.536-3.056-3.048L409.458,2.891C409.064,1.213,407.591,0,405.843,0c-1.732,0-3.222,1.213-3.631,2.891 l-15.203,57.667c-0.346,1.512-1.567,2.726-3.072,3.048L326.27,78.903c-1.702,0.339-2.883,1.812-2.883,3.56 C323.387,84.196,324.569,85.701,326.27,86.016z"></path>
                        <path d="M385.253,326.53l-26.176-6.939c-0.685-0.158-1.244-0.694-1.394-1.386l-6.9-26.175 c-0.181-0.764-0.851-1.308-1.646-1.308c-0.78,0-1.457,0.544-1.646,1.308l-6.9,26.175c-0.158,0.693-0.709,1.228-1.394,1.386 l-26.167,6.939c-0.772,0.15-1.316,0.828-1.316,1.615c0,0.788,0.544,1.466,1.316,1.623l26.167,6.932 c0.685,0.141,1.236,0.709,1.394,1.402l6.9,26.159c0.189,0.764,0.866,1.308,1.646,1.308c0.796,0,1.465-0.544,1.646-1.308l6.9-26.159 c0.15-0.693,0.709-1.261,1.394-1.402l26.176-6.932c0.756-0.157,1.308-0.835,1.308-1.623 C386.56,327.357,386.009,326.68,385.253,326.53z"></path>
                        <path d="M37.841,140.075l41.204,10.917c1.086,0.229,1.946,1.104,2.205,2.19l10.854,41.204 c0.299,1.221,1.363,2.064,2.6,2.064c1.244,0,2.3-0.843,2.592-2.064l10.862-41.204c0.229-1.086,1.119-1.961,2.198-2.19 l41.212-10.917c1.205-0.252,2.063-1.339,2.063-2.568c0-1.229-0.858-2.284-2.063-2.536l-41.212-10.934 c-1.079-0.236-1.969-1.086-2.198-2.174L97.296,80.636c-0.292-1.198-1.347-2.048-2.592-2.048c-1.236,0-2.3,0.85-2.6,2.048 l-10.854,41.228c-0.26,1.087-1.119,1.937-2.205,2.174l-41.204,10.934c-1.229,0.252-2.072,1.307-2.072,2.536 C35.769,138.736,36.612,139.824,37.841,140.075z"></path>
                        <path d="M396.595,276.897c-7.877-9.216-19.133-17.392-33.012-24.245h0.016c-27.68-13.706-65.638-22.094-107.583-22.118 l-0.118,0.007v-0.007c-27.546,0.007-53.398,3.623-75.745,9.988c-22.347,6.365-41.156,15.439-54.705,26.467l0.023-0.016 c-9.05,7.357-15.706,15.565-19.4,24.49c-2.112,5.065-3.222,10.405-3.214,15.816c0,4.451,3.608,8.066,8.066,8.066 c4.459,0,8.066-3.615,8.066-8.066c0.008-3.253,0.623-6.348,1.985-9.657c2.355-5.734,7.168-12.051,14.659-18.117l0.023-0.016 c11.154-9.137,28.184-17.581,48.916-23.449c20.732-5.916,45.198-9.374,71.326-9.366h0.425c39.629,0.008,75.429,8.145,100.1,20.433 l0.024,0.008c12.382,6.097,21.937,13.264,27.884,20.259c2.994,3.506,5.12,6.948,6.483,10.248c1.702,4.12,6.412,6.074,10.532,4.372 c4.12-1.701,6.073-6.412,4.372-10.531C403.613,286.373,400.542,281.497,396.595,276.897z"></path>
                        <path d="M485.912,271.966c-3.403-8.208-8.058-15.84-13.675-22.89c-5.616-7.042-12.185-13.517-19.496-19.472 l-0.448-0.362l0.433,0.362c-21.961-17.849-50.862-31.492-84.338-41.07h-0.008c-33.508-9.523-71.735-14.84-112.38-14.84 c-30.972,0-60.527,3.088-87.67,8.767c-27.144,5.68-51.877,13.95-73.208,24.489l-0.016,0.008 c-21.307,10.571-39.424,23.442-52.87,39.14l0.244-0.3l-0.252,0.3c-6.711,7.862-12.256,16.487-16.14,25.868 c-3.891,9.389-6.057,19.511-6.05,29.932v81.873c-0.007,10.43,2.159,20.559,6.05,29.948c3.403,8.208,8.059,15.832,13.675,22.882 c5.624,7.05,12.185,13.517,19.494,19.472l0.016,0.008c21.961,17.833,50.853,31.507,84.33,41.069l0.18,0.04 C177.255,506.683,215.418,511.992,256,512h0.008c30.964-0.008,60.518-3.096,87.662-8.775c27.144-5.68,51.877-13.958,73.208-24.49 l0.015-0.015c21.307-10.572,39.416-23.45,52.87-39.133l0.008-0.015c6.711-7.846,12.248-16.462,16.132-25.852l-0.244,0.575 l0.252-0.575c3.883-9.39,6.05-19.519,6.05-29.948v-81.873C491.961,291.477,489.795,281.355,485.912,271.966z M72.838,426.409 c-2.481-2.339-4.797-4.718-6.86-7.121c-4.892-5.734-8.563-11.602-11.013-17.51c-2.45-5.923-3.678-11.886-3.678-18.006v-37.116 c4.781,5.9,10.429,11.469,16.817,16.684c1.537,1.236,3.112,2.458,4.734,3.671V426.409z M118.083,454.932 c-3.111-1.355-6.175-2.742-9.114-4.206c-6.845-3.387-13.147-7.003-18.896-10.775v-61.676c8.578,4.923,17.951,9.436,28.01,13.501 V454.932z M174.111,472.505c-14.194-3.002-27.514-6.759-39.794-11.146h1.016v-63.29c3.946,1.307,7.995,2.544,12.122,3.726 c8.539,2.426,17.456,4.552,26.656,6.404V472.505z M247.375,480.657c-19.519-0.394-38.282-2.174-56.021-5.041v-64.401 c17.841,2.756,36.604,4.371,56.021,4.75V480.657z M322.804,475.23c-18.369,3.064-37.856,4.986-58.179,5.38v-64.607 c20.196-0.394,39.708-2.15,58.179-5.081V475.23z M378.833,460.965c-6.081,2.206-12.414,4.254-19.008,6.128 c-6.364,1.812-12.996,3.426-19.786,4.907v-64.228c13.651-2.82,26.632-6.333,38.794-10.437V460.965z M424.085,438.484 c-8.16,5.593-17.55,10.792-28.018,15.517v-63.125c5.041-2.088,9.933-4.278,14.604-6.585c4.671-2.324,9.137-4.758,13.414-7.279 V438.484z M460.713,383.771c0,6.12-1.228,12.084-3.686,18.006c-3.151,7.656-8.436,15.274-15.707,22.576v-58.242h-1.024 c7.152-5.459,13.493-11.28,18.826-17.51c0.543-0.638,1.063-1.284,1.59-1.93V383.771z M457.027,319.89 c-4.253,10.334-12.367,20.59-24.024,30.082c-17.448,14.241-42.756,26.593-73.177,35.233 c-30.412,8.665-65.922,13.667-103.825,13.667c-57.746,0.024-109.978-11.658-147.031-30.035 c-18.526-9.16-33.209-19.967-42.992-31.444c-4.892-5.727-8.563-11.595-11.013-17.502c-2.45-5.924-3.678-11.879-3.678-17.991 s1.228-12.067,3.678-17.991c4.27-10.342,12.367-20.598,24.033-30.074c17.456-14.25,42.756-26.608,73.177-35.249 c30.413-8.656,65.93-13.651,103.826-13.651c57.746-0.032,109.969,11.658,147.023,30.027c18.534,9.153,33.224,19.976,42.992,31.436 c4.899,5.727,8.57,11.595,11.012,17.51c2.458,5.924,3.686,11.878,3.686,17.991S459.485,313.966,457.027,319.89z"></path>
                    </svg>
                </card-button>
                <card-button
                    class="btn__stop"
                    v-if="account.loc === 'lots'"
                    @click="$store.commit('cancelLot', $props.box)"
                    title="Stop"
                >
                    <svg class="svg__big" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M 6 1 L 6 4 L 7 4 L 7 2 L 9 2 L 9 1 L 6 1 z M 11 1 L 11 2 L 14 2 L 14 1 L 11 1 z M 16 1 L 16 2 L 18 2 L 18 4 L 19 4 L 19 1 L 16 1 z M 1 6 L 1 19 L 14 19 L 14 6 L 1 6 z M 18 6 L 18 9 L 19 9 L 19 6 L 18 6 z M 2 7 L 13 7 L 13 18 L 2 18 L 2 7 z M 4.8789062 9.171875 L 4.171875 9.8789062 L 6.7929688 12.5 L 4.171875 15.121094 L 4.8789062 15.828125 L 7.5 13.207031 L 10.121094 15.828125 L 10.828125 15.121094 L 8.2070312 12.5 L 10.828125 9.8789062 L 10.121094 9.171875 L 7.5 11.792969 L 4.8789062 9.171875 z M 18 11 L 18 13 L 16 13 L 16 14 L 19 14 L 19 11 L 18 11 z "></path>
                    </svg>
                </card-button>
                <card-button
                    class="btn__use"
                    v-if="account.loc === 'storage'"
                    title="Use"
                >
                    <svg class="svg__big" viewBox="0 -4 160 160" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M138.184 97.8078C139.094 105.535 139.956 112.648 140.752 119.768C140.888 120.982 140.683 122.23 140.769 123.453C141.073 127.743 138.691 130.153 135.03 131.556C126.245 134.924 117.506 138.436 108.606 141.476C98.8597 144.804 88.9733 147.733 79.098 150.669C77.3869 151.144 75.5814 151.167 73.8585 150.734C56.5969 146.248 39.5624 141.055 23.1238 134.055C20.5156 133.047 17.9883 131.84 15.5641 130.446C14.2359 129.494 13.1891 128.201 12.5343 126.704C11.9843 125.56 12.0219 124.072 12.0193 122.736C11.9989 114.088 11.979 105.439 12.1122 96.7925C12.1933 96.1387 12.0667 95.4759 11.7497 94.8983C11.4328 94.3214 10.9417 93.8586 10.3467 93.5757C8.38915 92.479 6.52967 91.2156 4.78835 89.7998C1.22903 86.7964 0.702511 83.2443 3.20776 79.3155C4.23007 77.8427 5.39266 76.4722 6.67917 75.2232C10.0049 71.7446 13.3855 68.3245 16.8556 64.7673C12.9674 61.2822 9.29076 57.9948 5.62448 54.696C4.58526 53.8387 3.60305 52.9147 2.68409 51.9296C0.202479 49.024 0.530055 46.1538 3.57021 43.7969C5.16643 42.5597 6.85182 41.434 8.46903 40.227C20.967 30.8841 33.4376 21.5051 45.9697 12.208C48.4303 10.4403 50.983 8.80433 53.6173 7.30762C56.7769 5.44886 59.7585 5.75548 62.605 8.19177C66.1026 11.1853 69.7117 14.0477 73.292 16.9428C74.2424 17.7114 75.2611 18.3926 76.4595 19.2656C78.0584 17.4521 79.589 15.6971 81.1405 13.961C84.2089 10.5279 87.2839 7.09994 90.3654 3.67691C93.2532 0.465455 95.2019 -0.173334 98.9529 1.81078C105.785 5.42523 112.651 9.03923 119.147 13.2063C131.14 20.8993 142.878 28.9891 154.717 36.9223C155.369 37.3611 155.992 37.842 156.581 38.3622C159.472 40.9094 159.797 43.5789 157.307 46.6007C153.304 51.4675 148.983 56.0322 143.707 59.5823C143.344 59.8265 143.022 60.1312 142.428 60.613C146.05 64.425 149.572 68.1558 153.126 71.8582C154.373 73.1538 155.773 74.3037 156.957 75.6492C160.083 79.2019 160.034 82.6996 156.846 86.1762C154.391 88.9637 151.386 91.2123 148.019 92.7816C144.559 94.3417 141.243 96.2326 138.184 97.8078ZM129.5 62.2019C128.109 61.371 127.187 60.8025 126.248 60.2623C114.692 53.6071 103.155 46.9183 91.5638 40.3254C87.4768 38.0013 83.1909 36.0245 79.1177 33.6774C76.9236 32.4127 75.284 32.8286 73.3045 34.1367C61.242 42.1197 49.1128 50.0025 36.9935 57.8962C33.9231 59.8968 30.8068 61.8263 27.4634 63.9456C28.2733 64.4706 28.7144 64.8042 29.1981 65.0615C43.6724 72.6884 58.1926 80.2285 72.5957 87.9864C75.8045 89.7145 78.4948 90.1595 81.3558 87.6182C82.169 87.0209 83.0505 86.5221 83.9812 86.1329C97.3777 79.1074 110.776 72.084 124.175 65.064C125.834 64.1944 127.475 63.2914 129.5 62.2019ZM81.6892 25.7751C100.198 35.6629 117.443 46.8001 136.038 55.3994L147.727 43.5853C147.337 43.1704 146.92 42.7814 146.48 42.4204C135.503 35.0359 124.577 27.5733 113.51 20.328C108.83 17.2642 103.854 14.6516 99.0047 11.8516C97.4952 10.9794 96.2114 10.9984 94.8508 12.4266C90.5997 16.8812 86.216 21.2031 81.6892 25.7745V25.7751ZM19.8315 99.5189C20.6336 108.059 21.3669 115.753 22.0678 123.451C22.0842 124.013 22.286 124.555 22.6421 124.991C22.9983 125.426 23.4889 125.732 24.0368 125.859C24.9951 126.168 25.9119 126.6 26.859 126.954C40.839 132.183 55.2411 136.005 69.6671 139.741C70.496 139.884 71.3329 139.97 72.173 139.998V105.919C70.0071 108.297 68.3787 110.302 66.5232 112.072C64.6493 113.998 62.5733 115.716 60.3316 117.197C57.3295 119.016 53.9847 119.347 50.749 117.516C42.2603 112.714 33.7827 107.891 25.3159 103.047C23.6803 102.112 22.1425 101.014 19.8315 99.5182V99.5189ZM131.305 101.488C129.638 102.233 128.816 102.557 128.033 102.957C119.754 107.182 111.428 111.327 103.231 115.705C100.387 117.224 97.8548 117.245 95.3936 115.372C91.3807 112.317 87.4775 109.121 83.5316 105.979C82.7118 105.326 81.9111 104.65 80.9449 103.856C81.5914 116.312 82.2169 128.358 82.849 140.566C83.6628 140.352 84.4242 140.203 85.1462 139.953C89.8009 138.342 94.476 136.782 99.092 135.065C108.638 131.514 118.151 127.88 127.674 124.266C128.932 123.789 130.102 123.342 130.181 121.569C130.47 115.083 130.895 108.604 131.305 101.483V101.488ZM9.77849 83.7044L56.8345 109.981L70.6975 97.0517L21.8826 69.1449L9.77849 83.7044ZM85.8609 95.3912C89.9762 98.5875 93.8512 101.461 97.5588 104.535C99.4327 106.088 100.976 106.357 103.237 105.152C116.982 97.8275 130.812 90.6616 144.608 83.4314C145.567 82.9293 146.478 82.336 147.339 81.828L136.378 66.9593L85.8609 95.3912ZM56.532 15.9018C41.0372 25.4187 27.5219 37.3738 13.2675 47.2747L24.2939 58.7913L70.0701 27.8374L56.532 15.9018Z"></path>
                    </svg>
                </card-button>
                <card-button
                    v-if="account.loc === 'storage'"
                    class="btn__sell"
                    @click="$store.commit('page/setForm', {form: 'LotForm', data: $props.box})"
                    title="Sell"
                >
                    <svg class="svg__big" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 372.372 372.372">
                        <path d="M368.712,219.925c-5.042-8.951-14.563-14.511-24.848-14.511c-4.858,0-9.682,1.27-13.948,3.672l-83.024,46.756 c-1.084,0.61-1.866,1.642-2.163,2.85c-1.448,5.911-4.857,14.164-12.865,19.911c-8.864,6.361-20.855,7.686-35.466,3.939 c-0.088-0.022-0.175-0.047-0.252-0.071L148.252,267.6c-2.896-0.899-4.52-3.987-3.621-6.882c0.72-2.316,2.83-3.872,5.251-3.872 c0.55,0,1.101,0.084,1.634,0.249l47.645,14.794c0.076,0.023,0.154,0.045,0.232,0.065c11.236,2.836,20.011,2.047,26.056-2.288 c7.637-5.48,8.982-15.113,9.141-16.528c0.006-0.045,0.011-0.09,0.014-0.136c0.003-0.023,0.004-0.036,0.005-0.039 c0.001-0.015,0.002-0.03,0.003-0.044c0.001-0.01,0.001-0.019,0.002-0.029c0.909-11.878-6.756-22.846-18.24-26.089l-0.211-0.064 c-0.35-0.114-35.596-11.626-58.053-18.034c-2.495-0.711-9.37-2.366-19.313-2.366c-13.906,0-34.651,3.295-54.549,19.025 L1.67,292.159c-1.889,1.527-2.224,4.278-0.758,6.215l44.712,59.06c0.725,0.956,1.801,1.584,2.99,1.744 c0.199,0.027,0.398,0.04,0.598,0.04c0.987,0,1.954-0.325,2.745-0.935l57.592-44.345c1.294-0.995,3.029-1.37,4.619-0.995 l93.02,21.982c6.898,1.63,14.353,0.578,20.523-2.9l130.16-73.304C371.555,251.012,376.418,233.61,368.712,219.925z"></path>
                        <path d="M316.981,13.155h-170c-5.522,0-10,4.477-10,10v45.504c0,5.523,4.478,10,10,10h3.735v96.623c0,5.523,4.477,10,10,10h142.526 c5.523,0,10-4.477,10-10V78.658h3.738c5.522,0,10-4.477,10-10V23.155C326.981,17.632,322.503,13.155,316.981,13.155z M253.016,102.417h-42.072c-4.411,0-8-3.589-8-8c0-4.411,3.589-8,8-8h42.072c4.411,0,8,3.589,8,8 C261.016,98.828,257.427,102.417,253.016,102.417z M306.981,58.658h-3.738H160.716h-3.735V33.155h150V58.658z"></path>
                    </svg>
                </card-button>
                <card-button
                    class="btn__cost"
                    v-if="account.loc === 'production'"
                    title="Cost"
                >
                    <svg class="svg__big" viewBox="0 0 1920 1920" xmlns="http://www.w3.org/2000/svg">
                        <path d="M790.589 1750.588v56.471h56.47V1920H677.647v-169.412h112.942Zm417.794 56.471V1920h-180.662v-112.941h180.662Zm361.433 0V1920h-180.662v-112.941h180.662ZM1920 1750.588V1920h-169.412v-112.941h56.471v-56.471H1920ZM1581.177 338.824v225.882h-112.942V451.765H451.765v1016.47h112.941v112.942H338.824V338.824h1242.353ZM1920 1389.265v180.662h-112.941v-180.662H1920Zm-1129.412-.111v180.662H677.647v-180.662h112.941ZM1242.353 0v225.882h-112.941v-112.94H112.941v1016.47h112.941v112.94H0V0h1242.353ZM1920 1027.831v180.661h-112.941v-180.661H1920Zm-1129.412-.11v180.662H677.647v-180.662h112.941ZM1920 677.647v169.412h-112.941v-56.47h-56.471V677.647H1920Zm-1072.942 0v112.942h-56.47v56.47h-112.94V677.647h169.41Zm361.434 0v112.941h-180.661V677.647h180.661Zm361.435 0v112.941h-180.662V677.647h180.662Z" fill-rule="evenodd"></path>
                    </svg>
                </card-button>
                <card-button
                    class="btn__abort"
                    v-show="account.loc === 'production' && $props.box.process"
                    @click="$store.commit('abortCraft', $props.box)"
                    style="border-left: 1px solid black; border-right: 1px solid black;"
                    :style="getBarProgress"
                    title="Abort"
                >Abort</card-button>
                <card-button
                    v-show="account.loc === 'production' && !$props.box.process"
                    class="btn__craft"
                    :class="{'wait': $props.box.done === false}"
                    @click="$store.commit('startCraft', $props.box)"
                    title="Craft"
                >
                    <svg class="svg__big" viewBox="-1 -3 35 34" xmlns="http://www.w3.org/2000/svg">
                        <path d="M29 12.256h-1.88c-0.198-0.585-0.405-1.072-0.643-1.541l0.031 0.067 1.338-1.324c0.35-0.3 0.57-0.742 0.57-1.236 0-0.406-0.149-0.778-0.396-1.063l0.002 0.002-3.178-3.178c-0.283-0.246-0.654-0.395-1.061-0.395-0.494 0-0.937 0.221-1.234 0.57l-0.002 0.002-1.332 1.33c-0.402-0.206-0.888-0.413-1.39-0.586l-0.082-0.025 0.009-1.88c0.003-0.040 0.005-0.086 0.005-0.133 0-0.854-0.66-1.554-1.498-1.617l-0.005-0h-4.496c-0.844 0.063-1.505 0.763-1.505 1.617 0 0.047 0.002 0.093 0.006 0.139l-0-0.006v1.879c-0.585 0.198-1.071 0.404-1.54 0.641l0.067-0.031-1.324-1.336c-0.299-0.352-0.742-0.573-1.236-0.573-0.407 0-0.778 0.15-1.063 0.397l0.002-0.002-3.179 3.179c-0.246 0.283-0.396 0.655-0.396 1.061 0 0.494 0.221 0.937 0.57 1.234l0.002 0.002 1.329 1.329c-0.207 0.403-0.414 0.891-0.587 1.395l-0.024 0.082-1.88-0.009c-0.040-0.003-0.086-0.005-0.133-0.005-0.854 0-1.554 0.661-1.617 1.499l-0 0.005v4.495c0.062 0.844 0.763 1.505 1.617 1.505 0.047 0 0.093-0.002 0.139-0.006l-0.006 0h1.88c0.198 0.585 0.404 1.072 0.642 1.541l-0.030-0.066-1.335 1.32c-0.351 0.3-0.572 0.744-0.572 1.239 0 0.407 0.149 0.779 0.396 1.064l-0.002-0.002 3.179 3.178c0.249 0.246 0.591 0.399 0.97 0.399 0.007 0 0.014-0 0.021-0h-0.001c0.515-0.013 0.977-0.231 1.308-0.576l0.001-0.001 1.33-1.33c0.403 0.207 0.891 0.414 1.395 0.587l0.082 0.025-0.009 1.878c-0.003 0.040-0.005 0.086-0.005 0.132 0 0.854 0.661 1.555 1.499 1.617l0.005 0h4.496c0.843-0.064 1.503-0.763 1.503-1.617 0-0.047-0.002-0.093-0.006-0.139l0 0.006v-1.881c0.585-0.198 1.073-0.405 1.543-0.643l-0.067 0.031 1.321 1.333c0.332 0.344 0.793 0.562 1.304 0.574l0.002 0h0.002c0.006 0 0.013 0 0.019 0 0.378 0 0.72-0.151 0.971-0.395l3.177-3.177c0.244-0.249 0.395-0.591 0.395-0.968 0-0.009-0-0.017-0-0.026l0 0.001c-0.012-0.513-0.229-0.973-0.572-1.304l-0.001-0.001-1.331-1.332c0.206-0.401 0.412-0.887 0.586-1.389l0.025-0.083 1.879 0.009c0.040 0.003 0.086 0.005 0.132 0.005 0.855 0 1.555-0.661 1.617-1.5l0-0.005v-4.495c-0.063-0.844-0.763-1.504-1.618-1.504-0.047 0-0.093 0.002-0.138 0.006l0.006-0zM29.004 18.25l-2.416-0.012c-0.020 0-0.037 0.010-0.056 0.011-0.198 0.024-0.372 0.115-0.501 0.249l-0 0c-0.055 0.072-0.103 0.153-0.141 0.24l-0.003 0.008c-0.005 0.014-0.016 0.024-0.020 0.039-0.24 0.844-0.553 1.579-0.944 2.264l0.026-0.049c-0.054 0.1-0.086 0.218-0.086 0.344 0 0.001 0 0.003 0 0.004v-0c-0 0.016 0.003 0.028 0.004 0.045 0.006 0.187 0.080 0.355 0.199 0.481l-0-0 0.009 0.023 1.707 1.709c0.109 0.109 0.137 0.215 0.176 0.176l-3.102 3.133c-0.099-0.013-0.186-0.061-0.248-0.13l-0-0-1.697-1.713c-0.008-0.009-0.022-0.005-0.030-0.013-0.121-0.112-0.28-0.183-0.456-0.193l-0.002-0c-0.020-0.003-0.044-0.005-0.068-0.006l-0.001-0c-0.125 0-0.243 0.032-0.345 0.088l0.004-0.002c-0.636 0.362-1.373 0.676-2.146 0.903l-0.074 0.019c-0.015 0.004-0.025 0.015-0.039 0.020-0.096 0.042-0.179 0.092-0.255 0.149l0.003-0.002c-0.035 0.034-0.066 0.071-0.093 0.11l-0.002 0.002c-0.027 0.033-0.053 0.070-0.075 0.11l-0.002 0.004c-0.033 0.081-0.059 0.175-0.073 0.274l-0.001 0.007c-0.001 0.016-0.010 0.031-0.010 0.047v2.412c0 0.15-0.055 0.248 0 0.25l-4.41 0.023c-0.052-0.067-0.084-0.153-0.084-0.246 0-0.008 0-0.016 0.001-0.024l-0 0.001 0.012-2.412c0-0.017-0.008-0.032-0.010-0.048-0.005-0.053-0.015-0.102-0.030-0.149l0.001 0.005c-0.012-0.053-0.028-0.1-0.048-0.145l0.002 0.005c-0.052-0.086-0.109-0.16-0.173-0.227l0 0c-0.029-0.024-0.062-0.046-0.096-0.066l-0.004-0.002c-0.044-0.030-0.093-0.056-0.146-0.076l-0.005-0.002c-0.014-0.005-0.024-0.016-0.039-0.020-0.847-0.241-1.585-0.554-2.272-0.944l0.051 0.026c-0.099-0.054-0.216-0.086-0.341-0.086h-0c-0.022-0.001-0.040 0.004-0.062 0.005-0.18 0.008-0.342 0.080-0.465 0.193l0.001-0c-0.008 0.008-0.021 0.004-0.029 0.012l-1.705 1.705c-0.107 0.107-0.216 0.139-0.178 0.178l-3.134-3.101c0.012-0.1 0.060-0.187 0.13-0.25l0-0 1.714-1.695 0.011-0.026c0.115-0.123 0.189-0.286 0.197-0.466l0-0.002c0.001-0.021 0.005-0.037 0.005-0.058 0-0.001 0-0.002 0-0.003 0-0.126-0.032-0.245-0.088-0.348l0.002 0.004c-0.365-0.636-0.679-1.371-0.903-2.145l-0.018-0.072c-0.004-0.015-0.016-0.026-0.021-0.041-0.042-0.094-0.090-0.176-0.146-0.25l0.002 0.003c-0.065-0.061-0.136-0.117-0.212-0.165l-0.006-0.003c-0.051-0.025-0.109-0.045-0.171-0.057l-0.005-0.001c-0.029-0.009-0.065-0.016-0.102-0.021l-0.004-0c-0.020-0.002-0.037-0.012-0.058-0.012h-2.412c-0.152 0.002-0.248-0.055-0.25-0.002l-0.022-4.409c0.067-0.052 0.151-0.084 0.244-0.084 0.009 0 0.017 0 0.026 0.001l-0.001-0 2.416 0.012c0.152-0.004 0.292-0.054 0.407-0.136l-0.002 0.002c0.024-0.014 0.044-0.028 0.064-0.043l-0.002 0.001c0.109-0.088 0.191-0.206 0.235-0.341l0.001-0.005c0.003-0.010 0.014-0.014 0.017-0.025 0.242-0.847 0.555-1.583 0.946-2.27l-0.026 0.050c0.054-0.1 0.086-0.218 0.086-0.344 0-0.001 0-0.001 0-0.002v0c0.001-0.019-0.003-0.033-0.004-0.052-0.007-0.184-0.080-0.35-0.197-0.475l0 0-0.010-0.024-1.705-1.705c-0.108-0.11-0.142-0.221-0.176-0.178l3.102-3.134c0.101 0.008 0.189 0.058 0.248 0.131l0.001 0.001 1.697 1.713c0.018 0.018 0.046 0.011 0.065 0.027 0.125 0.121 0.295 0.196 0.483 0.196 0.13 0 0.251-0.036 0.355-0.098l-0.003 0.002c0.636-0.364 1.372-0.677 2.145-0.902l0.072-0.018c0.014-0.004 0.024-0.015 0.038-0.019 0.057-0.021 0.105-0.047 0.151-0.077l-0.003 0.002c0.163-0.090 0.281-0.244 0.321-0.427l0.001-0.004c0.014-0.043 0.025-0.093 0.030-0.145l0-0.003c0.001-0.016 0.009-0.030 0.009-0.046v-2.412c0-0.151 0.056-0.249 0.001-0.25l4.41-0.023c0.052 0.067 0.083 0.152 0.083 0.245 0 0.009-0 0.017-0.001 0.026l0-0.001-0.012 2.412c-0 0.016 0.008 0.030 0.009 0.047 0.005 0.055 0.015 0.106 0.031 0.155l-0.001-0.005c0.071 0.234 0.243 0.419 0.464 0.506l0.005 0.002c0.014 0.005 0.025 0.016 0.039 0.020 0.845 0.242 1.58 0.555 2.265 0.945l-0.050-0.026c0.105 0.060 0.231 0.096 0.366 0.096 0 0 0.001 0 0.001 0h-0c0.183-0.008 0.347-0.082 0.471-0.198l-0 0c0.017-0.015 0.043-0.008 0.059-0.024l1.709-1.705c0.105-0.106 0.213-0.137 0.176-0.176l3.133 3.102c-0.012 0.1-0.059 0.186-0.129 0.249l-0 0-1.715 1.697-0.011 0.026c-0.116 0.123-0.19 0.287-0.198 0.468l-0 0.002c-0.001 0.020-0.005 0.036-0.005 0.056 0 0.001 0 0.002 0 0.003 0 0.126 0.032 0.245 0.088 0.348l-0.002-0.004c0.365 0.636 0.679 1.371 0.902 2.144l0.018 0.071c0.003 0.012 0.016 0.017 0.019 0.028 0.046 0.137 0.127 0.253 0.232 0.339l0.001 0.001c0.019 0.015 0.041 0.030 0.063 0.043l0.003 0.002c0.112 0.080 0.252 0.13 0.402 0.134l0.001 0h2.412c0.152-0.001 0.248 0.057 0.25 0.001l0.021 4.409c-0.065 0.053-0.149 0.085-0.24 0.085-0.010 0-0.019-0-0.029-0.001l0.001 0zM16 11.25c-2.623 0-4.75 2.127-4.75 4.75s2.127 4.75 4.75 4.75c2.623 0 4.75-2.127 4.75-4.75v0c-0.003-2.622-2.128-4.747-4.75-4.75h-0zM16 19.25c-1.795 0-3.25-1.455-3.25-3.25s1.455-3.25 3.25-3.25c1.795 0 3.25 1.455 3.25 3.25v0c-0.002 1.794-1.456 3.248-3.25 3.25h-0z"></path>
                    </svg>
                </card-button>
            </div>
            <div v-if="$props.box.price" class="item-price">
                <p class="small" :title="`Last bid: ${$props.box.current_bid}G. Bid step: ${$props.box.bid_step}G.`">{{ $props.box.current_bid + $props.box.bid_step }}G</p>
                <p class="large">{{ $props.box.price }}G</p>
            </div>
        </div>
    </div>
</template>
<script>
import CardButton from '@/components/UI/CardButton.vue';
import { mapState } from 'vuex';

export default {
    components: {
        CardButton
    },
    props: {
        box: {
            type: Object,
            required: true
        }
    },
    computed: {

        ...mapState(["account"]),

        getCtaftingProgress() {
            return this.$props.box.progress
        },
        getBarProgress() {
            return `background-image:
                linear-gradient(
                    0.25turn,
                    var(--color-one),
                    var(--color-four) ${this.$props.box.progress}%,
                    transparent ${this.$props.box.progress}%,
                    transparent 100%)`
        },
        isDone() {
            return this.box.done
        }
    },
}
</script>
<style scoped>
.card__wrapper {
    aspect-ratio: 1.2;
    width: 24.5%;
    margin-top: 0.4%;
    margin-left: 0.4%;
    background-color: rgba(255, 255, 255, 0.6);
    transition: 0.5s all;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    padding: 1% 1% 0 1%;
    position: relative;
    overflow: hidden;
    isolation: isolate;

    @media screen and (min-width: 1601px) {
        width: 16.2%;
    }

    @media screen and (max-width: 1600px) {
        width: 19.5%;
    }

    @media screen and (max-width: 1400px) {
        width: 24.5%;
    }

    @media screen and (max-width: 1200px) {
        width: 32.8%;
    }

    @media screen and (max-width: 800px) {
        width: 49.4%;
    }

    @media screen and (max-width: 400px) {
        width: 100%;
    }
}
.card__wrapper:hover {
    background-color: rgba(255, 255, 255, 0.95);
    transform: translateY(1%);
    z-index: 99;
    box-shadow: 0 10px 5px 10px rgba(80, 147, 179, 0.3);
}

.item-name {
    width: 100%;
    height: 15%;
    display: flex;
    flex-flow: row;
    flex-wrap: nowrap;
    justify-content: space-between;
    font-size: clamp(18px, 0.3vmax + 0.3rem, 30px);
    align-items: center;
}

.item-info {
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    justify-content: space-between;
    align-items: flex-end;
    width: 50%;
    height: 50%;
}
.item-image {
    width: 50%;
    height: 50%;
    padding: 5px;
}
.info__btns {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
}

.item-text {
    padding-top: 10px;
    overflow: hidden;
}
.item-text div {
    padding-left: 5px;
    border-left: 1px solid rgba(80, 147, 179, 0.3);
    display: -webkit-box;
    overflow: hidden;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    white-space: pre-wrap;
}
.item-price {
    height: 100%;
    width: 20%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: flex-end;
    z-index: 99;
    border-bottom: 4px solid rgba(80, 147, 179, 0.3);
}

p.small {
    font-size: clamp(12px, 1.4rem, 20px);
    background-color: rgba(80, 147, 179, 0.3);
}

p.large {
    font-size: clamp(16px, 1.6rem, 30px);
}

.card__controls {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    height: calc(35% - 10px);
    border-top: 1px solid var(--color-one);
    margin-top: 10px;
}
.card__controls:not(:has(> .item-price)) {
    padding: 5px 0;
}

.card__btns {
    width: 80%;
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    background-image: linear-gradient(0.25turn, var(--color-one), transparent);
    padding: 5px 0 5px 5px;
}

.no {
    background-color: red;
    color: black;
}

.no:hover {
    animation-name: quake;
    animation-iteration-count: 5;
    animation-duration: 0.1s;
    animation-timing-function: linear;
    animation-direction: alternate;
}

@keyframes quake {
    from {
        transform: translateX(1%);
    }
    to {
        transform: translateX(-1%);
    }
}


.no.bidded {
    background-image: linear-gradient(0.20turn, red, red 50%, var(--color-three), var(--color-three) 50%);
}

svg {
    stroke: var(--color-five);
    fill: var(--color-five);
}

.svg__big {
    width: clamp(1.6em, 3vmin, 2em);
}
.faved svg {
    fill: gold;
    stroke: goldenrod;    
}
.btn__buy, .btn__sell, .btn__bid {
    width: 15%;
}

.btn__buy:hover svg {
    fill: rgb(111, 92, 66);
    stroke: black;
}

.btn__bid:hover svg {
    fill: rgb(142, 142, 142);
    stroke: black;
}
.btn__bid.bidded svg {
    fill: rgb(142, 142, 142);
    stroke: black;
}
.btn__fav:hover svg {
    fill: gold;
    stroke: goldenrod;
}

.btn__info:hover svg {
    fill: skyblue;
    stroke: black;
}

.btn__sell:hover svg {
    fill: royalblue;
    stroke: black;
}
.btn__use:hover svg {
    fill: greenyellow;
}

.btn__craft:hover svg {
    stroke: brown;
}
.btn__cost:hover svg {
    fill: firebrick;
    stroke: firebrick;
}

.btn__stop:hover svg {
    fill: red;
    stroke: red;
}

button:hover svg {
    fill: var(--color-six);
    animation-name: jiggle;
    animation-duration: 0.2s;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    animation-direction: alternate;
}

@keyframes jiggle {
    from {
        translate: 0 0;
    }
    to {
        translate: 0 -2px;
    }
}

.card__processing .loading__line {
    animation-name: processing;
    animation-duration: 1s;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    animation-direction: normal;
    opacity: 1;
}

.loading__line {
    position: absolute;
    top: 0;
    left: 0;
    translate: -75% 500%;
    rotate: 45deg;
    width: 200%;
    height: 50px;
    background-image:
        linear-gradient(
            rgba(255, 255, 255, 0.1),
            rgba(0, 128, 200, 0.1) 20%,
            rgba(0, 128, 200, 0.3),
            white 60%,
            rgba(0, 128, 200, 0.3),
            rgba(255, 255, 255, 0.1));
    opacity: 0;
    transition: 0.2s opacity;
    z-index: -1;
}

@keyframes processing {
    from {
        translate: -75% 500%;
    }
    to {
        translate: 50% -200%;
    }
}

</style>